<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/firebase-element/firebase-element.html">
<link rel="import" href="../pohoda-stage/pohoda-stage.html">

<polymer-element name="pohoda-now" attributes="stages stage">

    <template>

        <style shim-shadowdom>
            :host {
                height: 100%;
                width: 100%;
                display: -webkit-flex;
                display: flex;

                -webkit-justify-content: space-around;
                justify-content: space-around;

                -webkit-flex-flow: row no-wrap;
                flex-flow: row no-wrap;

                -webkit-align-items: stretch;
                align-items: stretch;
            }

            pohoda-stage:nth-of-type(1)::shadow progress {
                background: #D8DDEF;
            }

            pohoda-stage:nth-of-type(1)::shadow progress::-moz-progress-bar {
                background: #D8DDEF;
            }

            pohoda-stage:nth-of-type(1)::shadow progress::-webkit-progress-value {
                background: #D8DDEF;
            }

            pohoda-stage:nth-of-type(2)::shadow progress {
                background: #A0A4B8;
            }

            pohoda-stage:nth-of-type(2)::shadow progress::-moz-progress-bar {
                background: #A0A4B8;
            }

            pohoda-stage:nth-of-type(2)::shadow progress::-webkit-progress-value {
                background: #A0A4B8;
            }

            pohoda-stage:nth-of-type(3)::shadow progress {
                background: #7293A0;
            }

            pohoda-stage:nth-of-type(3)::shadow progress::-moz-progress-bar {
                background: #7293A0;
            }

            pohoda-stage:nth-of-type(3)::shadow progress::-webkit-progress-value {
                background: #7293A0;
            }

            pohoda-stage:nth-of-type(4)::shadow progress {
                background: #45B69C;
            }

            pohoda-stage:nth-of-type(4)::shadow progress::-moz-progress-bar {
                background: #45B69C;
            }

            pohoda-stage:nth-of-type(4)::shadow progress::-webkit-progress-value {
                background: #45B69C;
            }

            pohoda-stage:nth-of-type(5)::shadow progress {
                background: #21D19F;
            }

            pohoda-stage:nth-of-type(5)::shadow progress::-moz-progress-bar {
                background: #21D19F;
            }

            pohoda-stage:nth-of-type(5)::shadow progress::-webkit-progress-value {
                background: #21D19F;
            }
        </style>

        <firebase-element id="base" location="https://pohoda.firebaseio.com/stages" data="{{stages}}" keys="{{keys}}"></firebase-element>

        <template repeat="{{key in keys}}">
            <pohoda-stage stage="{{stages[key].name}}" artist="{{stages[key].artists[order].artist}}" country="{{stages[key].artists[order].country}}" time="{{stages[key].artists[order].time}}" on-stage-countdown-ended="{{nextArtist}}" style="top: {{key * 100/5}}vh; height: {{100/5}}vh;" fit></pohoda-stage>
        </template>

    </template>

    <script>
        (function() {
            'use strict';

            Polymer('pohoda-now', {

                // Fires when the "<polymer-element>" has been fully prepared
                ready: function() {
                    console.log('Pohoda is ready!');
                    this.order =  0;
                },

                // Fires when the element was inserted into the document
                attached: function() {

                },

                // Fires when the element was removed from the document
                detached: function() {

                },

                // Fires when an attribute was added, removed, or updated
                attributeChanged: function(attr, oldVal, newVal) {

                },

                nextArtist: function(event, detail, sender) {
                    console.log(sender);
                    this.order = 1;
                }

            });
        })();
    </script>

</polymer-element>
